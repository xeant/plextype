// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

model User {
    id               Int               @id @default(autoincrement()) // 회원 고유 id
    uuid             String            @default(cuid()) //외부에서 보여질 회원 id
    email            String            @unique // 회원 이메일
    nickname         String            @unique // 회원 닉네임
    password         String            // 비밀번호
    refreshToken     String?           // 로그인 유지를 위한 refreshToken
    createdAt        DateTime          @default(now()) // 회원가입 일
    updateAt         DateTime          @updatedAt // 회원정보 수정 일
    isAdmin          Boolean?          // 관리자 유무
    isManagers       Boolean?          // 매니저 유무
    document         Document[]
    profile          Profile?
}

model Profile {
    id               Int               @id @default(autoincrement())
    phone            String            @unique
    author           User              @relation(fields: [authorId], references: [id])
    authorId         Int               @unique
}

model Document {
    id               Int               @id @default(autoincrement())
    module           Module            @relation(fields: [moduleId], references: [id])
    moduleId         Int
    category         Category?         @relation(fields: [categoryId], references: [id])
    categoryId       Int?
    createdAt        DateTime          @default(now())
    updatedAt        DateTime          @updatedAt
    published        Boolean?          @default(false)
    author           User?             @relation(fields: [authorId], references: [id])
    authorId         Int?
    title            String?           @db.VarChar(255)
    description      String?           @db.LongText
    isNotice         Boolean?          @default(false)
    isSecrets        Boolean?          @default(false)
    readCount        Int?              @default(0)
    commentCount     Int?              @default(0)
    voteCount        Int?              @default(0)
}

model Category {
    id               Int               @id @default(autoincrement())
    title            String            @db.VarChar(45)
    document         Document[]
}

model Module {
    id               Int               @id @default(autoincrement())
    moduleId         String            @unique
    createdAt        DateTime          @default(now())
    updatedAt        DateTime          @updatedAt
    moduleType       String?           @db.VarChar(45)
    moduleName       String            @unique
    moduleDesc       String?
    grant            Json?             @db.Json
    config           Json?             @db.Json
    status           String?           @db.VarChar(45)
    document         Document[]
}
